<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>报警</title>
    <link rel="stylesheet" href="../../asset/introduce/layui/css/layui.css">
    <link rel="stylesheet" href="../../asset/css/reset.css">
    <link rel="stylesheet" href="../../asset/css/common.css">
    <link rel="stylesheet" href="./index.css">
</head>

<body>
    <!--头部-->
    <div class="header" id="header">
        <div class="header-rt">
            <ul>
                <li class="notice-wrapper">
                    <img class="notice-icon" src="../../asset/img/notice.png" alt="通知">
                </li>
                <li class="user-notice">
                    <div id="user-operate" class="user-operate">
                        <img class="user-img" src="../../asset/img/logo.png" alt="头像">
                        <a href="javascript:;">管理</a>
                        <a href="javascript:;" class="exit" title="退出">退出</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <!--侧边栏-->
    <div class="aside">
        <div class="menu-tree-wrapper">
            <ul id="menu-tree" class="menu-tree ztree"></ul>
        </div>
        <div class="palace">
            <div class="palace-unit">111</div>
            <div class="palace-unit">222</div>
            <div class="palace-unit">333</div>
            <div class="palace-unit">444</div>
            <div class="palace-unit">555</div>
            <div class="palace-unit">666</div>
        </div>
        <div class="icon-fold"><img id="showFlag" src="../../asset/img/icon_fold.png" alt="1"></div>
    </div>

    <!-- 主内容：报警 -->
    <dl class="wrap">
      <dt><span class="page-title">报警</span></dt>

      <dd>
        <form class="layui-form" action="">
          <div class="layui-form-item">

            <div class="layui-inline">
              <label class="layui-form-label">开始时间：</label>
              <div class="layui-input-inline">
                <input type="text" name="startTime" id="startTime" autocomplete="off" class="layui-input js-laydate">
              </div>
            </div>

            <div class="layui-inline">
              <label class="layui-form-label">结束时间：</label>
              <div class="layui-input-inline">
                <input type="text" name="endTime" id="endTime" autocomplete="off" class="layui-input js-laydate">
              </div>
            </div>

            <div class="layui-inline">
              <label class="layui-form-label">IP地址：</label>
              <div class="layui-input-inline">
                <input type="text" name="ipAddr" autocomplete="off" class="layui-input">
              </div>
            </div>

            <div class="layui-inline">
              <label class="layui-form-label">设备名称：</label>
              <div class="layui-input-inline">
                <input type="text" name="eqName" autocomplete="off" class="layui-input">
              </div>
            </div>

            <div class="layui-inline">
              <button class="layui-btn layui-btn-normal">查询</button>
              <button class="layui-btn layui-btn-primary">导出</button>
            </div>

          </div>
        </form>

        <table id="alarmList-table"></table>
      </dd>
    </dl>

    <!--页脚-->
    <div class="footer">
      技术支持：北京国势通科技有限公司
    </div>
    <script src="../../asset/js/jquery.min.js"></script>
    <!--<script src="../../asset/js/util.js"></script>-->
    <script src="../../asset/introduce/layui/layui.js"></script>
    <script>

      layui.use(['laydate','table'], function(){
        var laydate = layui.laydate;
        $('.js-laydate').each(function(){
          var elm = $(this).attr('id');
          laydate.render({
            elem: '#' + elm,
            format: 'yyyy-MM-dd'
          })
        })
        var BEGIN_DATE = $('input[name=startTime]').val();
        var END_DATE = $('input[name=endTime]').val();
        var table = layui.table;
          var TABLE_CONFIG = {
              alarmList: {
                  loaded: false,
                  loading: false,
                  id: 'alarmList',
                  url: 'http://172.16.5.224:18080/alarm/getAlarmList',
                  cols: [[ //标题栏
                    {type:'checkbox', width: 80}
                    ,{type:'numbers', title: '序号', width: 80}
                    ,{field: 'createTime', title: '时间', width: 180}
                    ,{field: 'ipAddress', title: 'IP地址', minWidth: 150}
                    ,{field: 'deviceName', title: '设备名称', minWidth: 120}
                    ,{field: 'alarmType', title: '报警类型', style: 'color: #f69506;', width: 120}
                    ,{field: 'json', title: '日志', style: 'color: #88898f;', width: 120}
                    ,{title: '', toolbar: '<div><a class="layui-icon layui-icon-delete" style="font-size: 30px; color: #88898f;"></a></div>', width: 80}
                  ]],
                  where: { },
                  done: function(res) {
                      console.log(res)
                  }
              }
          }
          var current = TABLE_CONFIG['alarmList']
          initTable(current)
//          startTime: BEGIN_DATE, endTime: END_DATE
//        table.render({
//          elem: '#alarmList'
//          ,page: true //开启分页
//          ,layout: ['count', 'prev', 'page', 'next']
//          ,skin: 'nob' //重要属性：无连线表格
//          ,cols: [[ //标题栏
//            {type:'checkbox', width: 80}
//            ,{type:'numbers', title: '序号', width: 80}
//            ,{field: 'timeline', title: '时间', width: 180}
//            ,{field: 'ipaddr', title: 'IP地址', minWidth: 150}
//            ,{field: 'eqname', title: '设备名称', minWidth: 120}
//            ,{field: 'alarmtype', title: '报警类型', style: 'color: #f69506;', width: 120}
//            ,{field: 'logs', title: '日志', style: 'color: #88898f;', width: 120}
//            ,{title: '', toolbar: '<div><a class="layui-icon layui-icon-delete" style="font-size: 30px; color: #88898f;"></a></div>', width: 80}
//          ]]
//            ,url: 'http://172.16.5.224:18080/alarm/getAlarmList'
//            ,where: {
//                deviceName: $('input[name=eqName]').val(),
//                ipAddress: $('input[name=ipAddr]').val()
//            }
//            ,request: {
//                pageName: 'pageSize' //页码的参数名称，默认：page
//                ,limitName: 'pageNum' //每页数据量的参数名，默认：limit
//            }
//            ,response: {
//                statusName: 'status' //规定数据状态的字段名称，默认：code
//                ,statusCode: 200 //规定成功的状态码，默认：0
//                ,msgName: 'hint' //规定状态信息的字段名称，默认：msg
//                ,countName: 'total' //规定数据总数的字段名称，默认：count
//                ,dataName: 'data' //规定数据列表的字段名称，默认：data
//            }
//        });
      })
      var DEFAULT_REQ = {
          pageName: 'pageNum',
          limitName: 'pageSize'
      }
      var DEFAULT_RES = {
          dataName: 'data.list',
          countName: 'data.total'
      }
      function initTable(currentTable) {
          var Table = layui.table
          var id = currentTable.id
          var tableId = id + '-table'

          if (currentTable.loading) return
          if (currentTable.loaded) {
              Table.reload(tableId)
              return
          }

          currentTable.loading = true
          currentTable.table = Table.render({
              elem: '#' + tableId,
              id: tableId, // height: 'full-0',
              url: currentTable.url,
              page: true,
              cols: [currentTable.cols],
              autoSort: currentTable.autoSort || false,
              request: currentTable.request || DEFAULT_REQ,
              response: currentTable.response || DEFAULT_RES,
              where: currentTable.where || {},
              done(arg) {
                  if (!currentTable.loaded) {
                      currentTable.loading = false
                      currentTable.loaded = true
                  }
                  if (typeof currentTable.done == 'function') {
                      currentTable.done(arg)
                  }
              }
          })
      }
    </script>
</body>

</html>