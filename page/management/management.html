<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>综合管理</title>
  <link rel="stylesheet" href="../../asset/introduce/layui/css/layui.css">
  <link rel="stylesheet" href="../../asset/css/common.css">
  <link rel="stylesheet" href="./management.css">
</head>

<body>
  <!--头部-->
  <div class="header">
    <a class="header-lt" id="header" href="../index/index.html"></a>
    <div class="header-rt">
      <ul>
        <li class="notice-wrapper">
          <img class="notice-icon" src="../../asset/img/notice.png" alt="通知">
        </li>
        <li class="user-notice">
          <div id="user-operate" class="user-operate">
            <img class="user-img" src="../../asset/img/logo.png" alt="头像">
            <a href="javascript:;">管理</a>
            <!-- <img class="icon-drop" src="../asset/img/drop-down.png" alt="下拉展开"> -->
            <a href="javascript:;" class="exit" title="退出">退出</a>
          </div>
          <!-- <div id="dropDown" class="drop-down">
              <a href="#">1</a>
              <a href="#">2</a>
              <a href="#">3</a>
          </div> -->
        </li>
      </ul>
    </div>
  </div>
  <!--侧边栏-->
  <div class="aside">
    <div class="menu-tree-wrapper">
      <ul id="menu-tree" class="menu-tree ztree"></ul>
    </div>
    <div class="palace">
      <div class="palace-unit">111</div>
      <div class="palace-unit">222</div>
      <div class="palace-unit">333</div>
      <div class="palace-unit palace-left">444</div>
      <div class="palace-unit palace-ct">555</div>
      <div class="palace-unit palace-last">666</div>
    </div>
    <div class="icon-fold"><img id="showFlag" src="../../asset/img/icon_fold.png" alt="1"></div>
  </div>
  <!--主体-->
  <div class="main">
    <div class="tabview">
      <ul class="tabtop js-tabtop">
        <li class="js-tabhd">
          <a href="javascript:void(0)">地图模式</a>
        </li>
        <li class="js-tabhd on">
          <a href="javascript:void(0)">分屏模式</a>
        </li>
      </ul>
      <!-- tab-hd =end= -->

      <!-- tab-bd =start= -->
      <ul class="tabmain js-tabmain">
        <li class="js-tabbd">
          <!-- tab-bd>>>li =start= -->
          <div class="map-box">
            <img class="map-img-bg" src="../../asset/img/map_bg.png">

            <dl class="inner-box">
              <dd class="map-img-content" id='map-img-content'>
                <img class="map-img" id="img" src="../../asset/img/map.jpg">
                <img class="camera camera1" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera2" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera3" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera4" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera5" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera6" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera7" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera8" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera9" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera10" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera11" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera12" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera13" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera14" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera15" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera16" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera17" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera18" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera19" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera20" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera21" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera22" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera23" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera24" src="../../asset/img/cam-small.png" alt="">
                <img class="camera camera25" src="../../asset/img/cam-small.png" alt="">

                <img class="camera camera1-1" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-2" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-3" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-4" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-5" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-6" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-7" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-8" src="../../asset/img/cam-ball.png" alt="">
                <img class="camera camera1-9" src="../../asset/img/cam-ball.png" alt="">

                <img class="camera camera2-1" src="../../asset/img/cam-big2.png" alt="">
                <img class="camera camera2-2" src="../../asset/img/cam-big2.png" alt="">
                <img class="camera camera2-3" src="../../asset/img/cam-big2.png" alt="">
                <img class="camera camera2-4" src="../../asset/img/cam-big2.png" alt="">
                <img class="camera camera2-5" src="../../asset/img/cam-big2.png" alt="">
                <img class="camera camera2-6" src="../../asset/img/cam-big2.png" alt="">
              </dd>
              <dt>
                <a href="javascript:;" class="btn-zoom btn-zoomin"></a>
                <a href="javascript:;" class="btn-zoom btn-zoomout"></a>
                <a href="javascript:;" class="btn-zoom btn-zoomtrack">智能追踪</a>
                <a href="javascript:;" class="btn-zoom btn-zoommonitor">执勤监控</a>
              </dt>
            </dl>
          </div>
          <!-- tab-bd>>>li =end= -->
        </li>
        <li class="js-tabbd on">
          <!-- tab-bd>>>li =start= -->
          <div class="split-mode">
            <ul id="mode-rec" class="mode-content mode-rec-4">
              <li>
                <dl>
                  <dd class="videos"></dd>
                  <dt class="v-toolbar">
                    <a href="javascript:;" class="icon-history"><img src="../../asset/img/icon-history.png"> 历史记录</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-control.png"> 云台控制</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-close.png"> 关闭</a>
                    <div class="opt-monitor">
                      <a href="javascript:;" class="opt-item opt-top-lt"></a>
                      <a href="javascript:;" class="opt-item opt-top-ct"></a>
                      <a href="javascript:;" class="opt-item opt-top-rt"></a>
                      <a href="javascript:;" class="opt-item opt-mid-lt"></a>
                      <a href="javascript:;" class="opt-item opt-mid-rt"></a>
                      <a href="javascript:;" class="opt-item opt-bot-lt"></a>
                      <a href="javascript:;" class="opt-item opt-bot-ct"></a>
                      <a href="javascript:;" class="opt-item opt-bot-rt"></a>
                      <a href="javascript:;" class="opt-item opt-big"></a>
                      <a href="javascript:;" class="opt-item opt-small"></a>
                    </div>
                  </dt>
                </dl>
              </li>
              <li>
                <dl>
                  <dd class="videos"></dd>
                  <dt class="v-toolbar">
                    <a href="javascript:;"><img src="../../asset/img/icon-history.png"> 历史记录</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-control.png"> 云台控制</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-close.png"> 关闭</a>
                  </dt>
                </dl>
              </li>
              <li>
                <dl>
                  <dd class="videos"></dd>
                  <dt class="v-toolbar">
                    <a href="javascript:;"><img src="../../asset/img/icon-history.png"> 历史记录</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-control.png"> 云台控制</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-close.png"> 关闭</a>
                  </dt>
                </dl>
              </li>
              <li>
                <dl>
                  <dd class="videos"></dd>
                  <dt class="v-toolbar">
                    <a href="javascript:;"><img src="../../asset/img/icon-history.png"> 历史记录</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-control.png"> 云台控制</a>
                    <a href="javascript:;"><img src="../../asset/img/icon-close.png"> 关闭</a>
                  </dt>
                </dl>
              </li>
              <span class="clearfix"></span>
            </ul>

            <div class="slider-operate">
              <img src="../../asset/img/btn_1_1.png" alt="">
              <div id="slide" class="slider"></div>
              <img src="../../asset/img/btn_4_4.png" alt="">
              <img src="../../asset/img/btn_big.png" alt="">
            </div>
          </div>
          <!-- tab-bd>>>li =end= -->
          <!--历史记录 start-->
          <div class="history-wrapper">
            <div class="history-top mode-content">
              <div class="video-wrapper">
                <div class="video"></div>
                <div class="v-toolbar">
                  <a href="javascript:;" class="icon-speed"><img src="../../asset/img/icon_speed.png"> 倍速</a>
                  <a href="javascript:;"><img src="../../asset/img/icon_pause.png"> 停止播放</a>
                  <a href="javascript:;" class="icon-history"><img src="../../asset/img/icon-close.png"> 关闭</a>
                  <div class="speed-wrapper">
                    <a href="javascript:;" class="speed-item">6.0X</a>
                    <a href="javascript:;" class="speed-item">4.0X</a>
                    <a href="javascript:;" class="speed-item">2.0X</a>
                    <a href="javascript:;" class="speed-item">1.0X</a>
                    <a href="javascript:;" class="speed-item">1/2X</a>
                    <a href="javascript:;" class="speed-item">1/4X</a>
                  </div>
                </div>
              </div>
              <div class="date-wrapper">
                <div class="calendar" id="calendar"></div>
                <div class="search-btn">搜索录像</div>
              </div>
            </div>
            <div class="scale-wrapper">
              <div class="scale-title">历史视频时间段控制</div>
              <div class="scale">
                <div class="scale-num"><img src="../../asset/img/scalenum.png"></div>
                <img src="../../asset/img/graduation.png" class="scale-bar" />
                <div class="scale-box">
                  <span data-count="0" class="scale-unit spec"></span>
                  <span data-count="1" class="scale-unit"></span>
                  <span data-count="2" class="scale-unit"></span>
                  <span data-count="3" class="scale-unit"></span>
                  <span data-count="4" class="scale-unit"></span>
                  <span data-count="5" class="scale-unit"></span>
                  <span data-count="6" class="scale-unit"></span>
                  <span data-count="7" class="scale-unit"></span>
                  <span data-count="8" class="scale-unit"></span>
                  <span data-count="9" class="scale-unit"></span>
                  <span data-count="10" class="scale-unit"></span>
                  <span data-count="11" class="scale-unit"></span>
                  <span data-count="12" class="scale-unit"></span>
                  <span data-count="13" class="scale-unit"></span>
                  <span data-count="14" class="scale-unit"></span>
                  <span data-count="15" class="scale-unit"></span>
                  <span data-count="16" class="scale-unit"></span>
                  <span data-count="17" class="scale-unit"></span>
                  <span data-count="18" class="scale-unit"></span>
                  <span data-count="19" class="scale-unit"></span>
                  <span data-count="20" class="scale-unit"></span>
                  <span data-count="21" class="scale-unit"></span>
                  <span data-count="22" class="scale-unit"></span>
                  <span data-count="23" class="scale-unit"></span>
                </div>
              </div>
            </div>
          </div>
          <!--历史记录 end-->
        </li>
      </ul>
    </div>
  </div>

  <script src="../../asset/js/jquery.min.js"></script>
  <script src="../../asset/js/utils.js"></script>
  <script src="../../asset/introduce/layui/layui.js"></script>
  <script src="../../asset/js/aside.js"></script>
  <script>
    var _this = this
    //计算高度，超出隐藏
    function caleHeight(itemnumb){
      // 设置分屏模式视频高度
      var itemWidth = $('.mode-content .videos').width();
      var itemHeight = itemWidth * 9 / 16;
      $('.mode-content .videos').css('height', itemHeight);
      $('#mode-rec').css({
        'height':itemHeight*itemnumb,
        'overflow':'hidden'
      })
    }
    _this.caleHeight(4)
    //滑块
    layui.use('slider', function () {
      var slider = layui.slider;
      //设置步长
      slider.render({
        elem: '#slide',
        step: 1, //步长,
        min: 1,
        max: 4,
        value: 4,
        change: function (value) {
          //do something
          if (value == 4) {
            $('#mode-rec').removeClass('mode-rec-1')
            $('#mode-rec').removeClass('mode-rec-2')
            $('#mode-rec').removeClass('mode-rec-3')
            $('#mode-rec').addClass('mode-rec-4')
            _this.caleHeight(4)
          } else if (value == 3) {
            $('#mode-rec').removeClass('mode-rec-1')
            $('#mode-rec').removeClass('mode-rec-2')
            $('#mode-rec').removeClass('mode-rec-4')
            $('#mode-rec').addClass('mode-rec-3')
            _this.caleHeight(3)
          } else if (value == 2) {
            $('#mode-rec').removeClass('mode-rec-1')
            $('#mode-rec').removeClass('mode-rec-3')
            $('#mode-rec').removeClass('mode-rec-4')
            $('#mode-rec').addClass('mode-rec-2')
            _this.caleHeight(2)
          } else if (value == 1) {
            $('#mode-rec').removeClass('mode-rec-2')
            $('#mode-rec').removeClass('mode-rec-3')
            $('#mode-rec').removeClass('mode-rec-4')
            $('#mode-rec').addClass('mode-rec-1')
            _this.caleHeight(1)
          }
        }
      });
    })

    // 渲染日期组件
    layui.use('laydate', function() {
        var laydate = layui.laydate;
        laydate.render({
            elem: '#calendar',
            btns: [],
            position: 'static'
        });
    })

    // 点击历史记录显示
    $('body').on('click', '.icon-history', function () {
        $('.split-mode').hide()
        $('.history-wrapper').show()
        // 设置历史记录视频高度
        var historyVideoWidth = $('.video-wrapper .video').width();
        var historyVideoHeight = historyVideoWidth * 9 /16;
        var searchMarTop = (historyVideoHeight - 386) / 2
        $('.video-wrapper .video').css('height', historyVideoHeight);
        $('.search-btn').css('marginTop', searchMarTop ); // 设置搜索按钮位置
    })
    //点击倍速
    $('body').on('click', '.icon-speed', function () {
      $('.speed-wrapper').stop().slideToggle('fast')
    })
    // 点击倍速的某一项
    $('body').on('click', '.speed-item', function () {
        var $that = $(this)
        $that.addClass('on').siblings().removeClass('on')
        $that.parent().slideUp('fast')
    })
    // 点击历史记录中的关闭按钮
    $('body').on('click', '.history-wrapper .icon-history', function () {
        $('.history-wrapper').hide();
        $('.split-mode').show();
    })
    // 双击刻度条某一项
    $('body').on('dblclick', '.scale-unit', function (e) {
        var count = parseInt(e.currentTarget.dataset.count);
//        $(this).addClass('active').siblings().removeClass('active')
        $('.scale-unit').removeClass('active')
        for (var i = 0; i <= count; i++){
            $('.scale-unit').eq(i).addClass('active')
        }
    })
    // 刻度条
    var initCount = null
    $('body').on('click', '.scale-unit', function (e) {
      var count1 = null,
          count2 = null;
      var $that = $(this);
      $('.scale-unit').removeClass('active');
      $that.addClass('active');
      if (initCount){
          count2 = parseInt(e.currentTarget.dataset.count);
          var delta = parseInt(initCount)
          if (delta < count2){
              for (var i = delta; i <= count2; i++){
                  $('.scale-unit').eq(i).addClass('active')

              }
          }else {
              for (var j = count2; j <= delta; j++){
                  $('.scale-unit').eq(j).addClass('active')
              }
          }

          initCount = count2
      }else{
          count1 = e.currentTarget.dataset.count;
          initCount = count1
      }
    })

  </script>
  <script>
    //放大
    $('.btn-zoomin').on('click', function () {
      $('.map-img-content').addClass('scale-img')
      $('.map-img-content').css({
        left:0,
        top:0
      })
    })
    //缩小
    $('.btn-zoomout').on('click', function () {
      $('.map-img-content').removeClass('scale-img')
      $('.map-img-content').css({
        left:0,
        top:0
      })
    })
  </script>
  
<script>
  //拖动功能
var _drag = {};
_drag.top = 0; //拖动过的位置距离上边
_drag.left = 0; //拖动过的位置距离左边
_drag.maxLeft; //距离左边最大的距离
_drag.maxTop; //距离上边最大的距离
_drag.dragging = false; //是否拖动标志
//拖动函数
function bindDrag(el) {
    var winWidth = $(window).width(),
    winHeight = $(window).height(),
    objWidth = $(el).outerWidth(),
    objHeight = $(el).outerHeight();
    _drag.maxLeft = winWidth - objWidth,
    _drag.maxTop = winHeight - objHeight;
    var els = el.style,
    x = 0,
    y = 0;
    var objTop = $(el).offset().top,
    objLeft = $(el).offset().left;
    $(el).mousedown(function(e) {
        _drag.dragging = true;
        _drag.isDragged = true;
        x = e.clientX - el.offsetLeft;
        y = e.clientY - el.offsetTop;
        el.setCapture && el.setCapture();
        $(document).bind('mousemove', mouseMove).bind('mouseup', mouseUp);
        return false;
    });
    function mouseMove(e) {
        e = e || window.event;
        if (_drag.dragging) {
            _drag.top = e.clientY - y;
            _drag.left = e.clientX - x;
            _drag.top = _drag.top > _drag.maxTop ? _drag.maxTop: _drag.top;
            _drag.left = _drag.left > _drag.maxLeft ? _drag.maxLeft: _drag.left;
            _drag.top = _drag.top < 0 ? 0 : _drag.top;
            _drag.left = _drag.left < 0 ? 0 : _drag.left;
            els.top = _drag.top + 'px';
            els.left = _drag.left + 'px';
            return false;
        }
    }
    function mouseUp(e) {
        _drag.dragging = false;
        el.releaseCapture && el.releaseCapture();
        e.cancelBubble = true;
        $(document).unbind('mousemove', mouseMove).unbind('mouseup', mouseUp);
    }
    $(window).resize(function() {
        var winWidth = $(window).width(),
        winHeight = $(window).height(),
        el = $(el),
        elWidth = el.outerWidth(),
        elHeight = el.outerHeight(),
        elLeft = parseFloat(el.css('left')),
        elTop = parseFloat(el.css('top'));
        _drag.maxLeft = winWidth - elWidth;
        _drag.maxTop = winHeight - elHeight;
        _drag.top = _drag.maxTop < elTop ? _drag.maxTop: elTop;
        _drag.left = _drag.maxLeft < elLeft ? _drag.maxLeft: elLeft;
        el.css({
            top: _drag.top,
            left: _drag.left
        })
    })
}
bindDrag(document.getElementById('map-img-content'));
</script>
</body>

</html>